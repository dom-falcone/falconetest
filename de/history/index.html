<!doctype html>
<html lang="de">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Geschichte - Falcone</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@300;400;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../../assets/css/style.css?v=6">
    <link rel="icon" href="../../assets/images/Falcone-circle.png" type="image/png">
    <link rel="stylesheet" href="../../assets/css/user-menu.css?v=1">
</head>

<body>
    <!-- Page Loader -->
    <div id="page-loader">
        <div class="loader-content">
            <div class="loader-text">Bitte warten. Wird geladen.</div>
            <div class="loader-hymn-section">
                <div class="loader-hymn-label">Hymne des Hauses Falcone</div>
                <div class="loader-player-container">
                    <div class="loader-play-btn" id="loader-play-btn">
                        <div class="loader-play-icon"></div>
                    </div>
                    <div class="loader-progress-container">
                        <div class="loader-progress-bar" id="loader-progress"></div>
                    </div>
                </div>
                <audio id="loader-audio" src="../../assets/audio/hymn.mp3"></audio>
            </div>
        </div>
    </div>
    <header class="topbar">
        <div class="container topbar-inner">
            <div class="brand">
                <a href="../homepage">
                    <div class="logo-mark"
                        style="background: url('../../assets/images/Falcone.png') no-repeat center/cover;"></div>
                    <span class="brand-title">Dom Falcone</span>
                </a>
            </div>

            <!-- Desktop Navigation -->
            <nav class="nav">
                <a href="../about">√úber das Haus</a>
                <a href="../history">Geschichte</a>
                <a href="../enemies">Feinde</a>
                <a href="../news">Neuigkeiten</a>
            </nav>
            <!-- Language Switcher -->
            <div class="lang-switcher">
                <a href="../../ru/history">RU</a>
                <span class="divider">|</span>
                <a href="#" class="active">DE</a>
            </div>

            <!-- Burger Menu Button -->
            <div class="burger-menu" id="burger-menu">
                <div class="burger-line"></div>
                <div class="burger-line"></div>
                <div class="burger-line"></div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∞ "Anmelden" (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω) -->
            <div class="auth-action" id="auth-action" style="display: none;">
                <a href="../login" class="btn-login">Anmelden</a>
            </div>

            <!-- User Menu (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω) -->
            <div class="user-menu" id="user-menu" style="display: none;">
                <!-- –ö–Ω–æ–ø–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π -->
                <div style="position: relative;">
                    <a href="../messages" class="notification-bell" style="text-decoration: none;">
                        <svg viewBox="0 0 24 24">
                            <path
                                d="M20,2H4A2,2 0 0,0 2,4V22L6,18H20A2,2 0 0,0 22,16V4A2,2 0 0,0 20,2M6,9H18V11H6M14,14H6V12H14M18,8H6V6H18" />
                        </svg>
                        <span class="notification-badge" id="messages-badge" style="display: none;">0</span>
                    </a>
                </div>

                <!-- –ö–Ω–æ–ø–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
                <div style="position: relative;">
                    <div class="notification-bell" id="notification-bell">
                        <svg viewBox="0 0 24 24">
                            <path
                                d="M12,22A2,2 0 0,1 10,20H14A2,2 0 0,1 12,22M18,16V11C18,7.93 16.37,5.36 13.5,4.68V4A1.5,1.5 0 0,0 12,2.5A1.5,1.5 0 0,0 10.5,4V4.68C7.63,5.36 6,7.92 6,11V16L4,18V19H20V18L18,16M12,6A5,5 0 0,1 17,11V17H7V11A5,5 0 0,1 12,6Z" />
                        </svg>
                        <span class="notification-badge" id="notification-badge" style="display: none;">0</span>
                    </div>

                    <!-- –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
                    <div class="notifications-dropdown" id="notifications-dropdown">
                        <div class="notifications-header">
                            <h3>Benachrichtigungen</h3>
                            <button class="mark-all-read" id="mark-all-read-btn">Alle gelesen</button>
                        </div>
                        <div id="notifications-list">
                            <div class="no-notifications">Keine Benachrichtigungen</div>
                        </div>
                    </div>
                </div>

                <!-- Profil –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                <a href="../dashboard" class="user-profile-info">
                    <img src="" alt="Avatar" id="header-avatar" class="header-avatar">
                    <div class="user-details">
                        <span class="user-display-name" id="header-display-name">User</span>
                        <div class="user-points-badge">
                            <span>‚≠ê</span>
                            <span id="header-points">0</span>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </header>

    <!-- Mobile Navigation Overlay -->
    <div class="mobile-nav-overlay" id="mobile-nav-overlay"></div>

    <!-- Mobile Navigation Menu -->
    <nav class="mobile-nav" id="mobile-nav">
        <div class="mobile-nav-links">
            <a href="../about">√úber das Haus</a>
            <a href="../history">Geschichte</a>
            <a href="../enemies">Feinde</a>
            <a href="../news">Neuigkeiten</a>
            <a href="../dashboard" class="mobile-nav-profile">Profil</a>
            <a href="../messages" class="mobile-nav-messages">Nachrichten</a>
        </div>
        <div class="mobile-nav-footer">
            <div class="site-version"></div>
        </div>
    </nav>



    <div class="page-header"
        style="background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.3)), url('../../assets/images/JimBeam-Magazin.jpg') center/cover no-repeat; background-position: center 73%;">
        <div class="container">
            <h1>Geschichte des Hauses Falcone</h1>
            <p>Die Legende der Gr√ºndung des Hauses Falcone</p>
        </div>
    </div>

    <main class="content-section">
        <div class="container">
            <div class="content-block">
                <h2>Die Entstehung des Hauses Falcone</h2>
                <p>Das Haus Falcone entstand in der heiligen Nacht vom vierten auf den f√ºnften Oktober 2025, als
                    furchtlose
                    Krieger zum ersten Mal aufstanden, um ihre Ideale zu verteidigen.</p>
            </div>

            <div class="timeline">
                <div class="timeline-item">
                    <h3>Die Gro√üe Schlacht</h3>
                    <div class="date">4.-5. Oktober 2025</div>
                    <p>Alles begann am 4. Oktober mit der Abreise der Mutter des Kriegers Maksym, der sp√§ter als
                        Maxone de Povarone bekannt werden sollte. Der Geist der Freiheit umh√ºllte Maksym und seinen
                        Kameraden Dmitrij, der
                        sp√§ter den Namen Dimone de Patrone tragen wird. Die furchtlosen Krieger gingen um 8
                        Uhr morgens in den Kaufland f√ºr die legend√§re 1,5-Liter-Flasche Jim Beam im Angebot (19,99 Euro
                        pro Flasche). Zusammen damit
                        wurden auch etwa 10 Liter Pepsi als Mischgetr√§nk gekauft, die die Krieger gar nicht brauchen
                        w√ºrden.</p>
                    <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <img src="../../assets/images/history1.png" alt="Die Gro√üe Schlacht"
                            style="width: 45%; max-width: 400px; border-radius: 8px;">
                    </div>
                    <p class="image-caption"
                        style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                        Auf dem Foto: Dimone de Patrone und Jim Beam
                    </p>
                    <p style="margin-top: 1rem;">Die Krieger gingen nach Hause zu Maksym, wo sie das legend√§re
                        Gericht des Hauses Falcone zubereiteten - Nudeln mit K√§se und Thunfisch. Genau dank dieses
                        Gerichts erhielt Maxone de
                        Povarone seinen Titel "de Povarone". Die K√§mpfer bereiteten sich darauf vor, den ungleichen
                        Kampf mit
                        dem Gegner zu beginnen.</p>
                    <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap;">
                            <div style="width: 45%; max-width: 400px;">
                                <img src="../../assets/images/history2.jpg" alt="–ì–æ—Ç–æ–≤–∫–∞"
                                    style="width: 100%; border-radius: 8px;">
                                <p class="image-caption"
                                    style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                                    Maxone de Povarone bereitet das Hausgericht zu
                                </p>
                            </div>
                            <div style="width: 45%; max-width: 400px;">
                                <img src="../../assets/images/history3.jpg" alt="–ë—É—Ä–±–æ–Ω"
                                    style="width: 100%; border-radius: 8px;">
                                <p class="image-caption"
                                    style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                                    Jim Beam vor Beginn der Schlacht
                                </p>
                            </div>
                        </div>
                    </div>
                    <p style="margin-top: 1rem;">Aber der Gegner war zu stark. Dmitrij und Maksym verloren die Schlacht
                        und
                        gingen schon mittags schlafen, schlafend bis etwa 16 Uhr.</p>
                    <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <img src="../../assets/images/history4.jpg" alt="–ú–∞–∫—Å–∏–º —Å–ø–∏—Ç"
                            style="width: 45%; max-width: 400px; border-radius: 8px;">
                    </div>
                    <p class="image-caption"
                        style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                        Auf dem Foto: Maxone de Povarone erholt sich nach der ersten Schlacht
                    </p>

                    <p style="margin-top: 1rem;">Nach dieser Niederlage verstanden Dmitrij und Maksym, dass sie
                        Verst√§rkung rufen mussten. Es wurden Vereinbarungen mit Arkadij (Don Falcone) und Anton (Antone
                        de
                        Snusone) √ºber den gemeinsamen Kampf gegen Jim Beam getroffen. An der folgenden Schlacht nahmen
                        auch
                        Timofej und sein Freund Mark teil, der aus der Ukraine angereist war. Die furchtlosen Krieger
                        kauften auch Jim Beam
                        Cherry Lik√∂r, was ihr Schicksal noch schlimmer machte. Bevor sie die Hauptschlacht begannen,
                        beschlossen die Krieger,
                        in eine Bar zu gehen, um einen Cocktail zu trinken, was sie auch taten. Nach der Bar wurde
                        beschlossen, in den Keller von Arkadij zu gehen, wo dann die Gr√ºndung des Hauses
                        Falcone verk√ºndet werden sollte. Zum Zeitpunkt der Ankunft im Keller hatten die Krieger bereits
                        einen kleinen
                        Schaden erlitten.</p>

                    <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <img src="../../assets/images/history5.jpg" alt="–í–æ–∏–Ω—ã –≤ –ø–æ–¥–≤–∞–ª–µ"
                            style="width: 45%; max-width: 400px; border-radius: 8px;">
                    </div>
                    <p class="image-caption"
                        style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                        Auf dem Foto: Maxone de Povarone im Keller von Don Falcone
                    </p>

                    <p style="margin-top: 1rem;">Dimone de Patrone verlie√ü das Schlachtfeld fr√ºher als die anderen.
                        Einige
                        Tage sp√§ter wurden die Details des Abends enth√ºllt. Mit jedem getrunkenen Schnapsglas verwendete
                        Arkadij
                        immer weniger menschliche Sprache, und beim letzten Glas h√∂rte er ganz auf zu sprechen und
                        zeigte nur noch mit Gesten. Anton wurde rot wie eine Tomate. Die K√§mpfer verstanden, dass die
                        Schlacht verloren war.
                        Genau in diesem Zustand wurde die Gr√ºndung des Hauses Falcone m√∂glich. Anfangs nannten sie
                        Arkadij Don
                        Purdun, aber schlie√ülich verk√ºndete Arkadij: "Ich bin der Don des Hauses Falcone!". Als Ergebnis
                        dieser Schlacht wurde Jim
                        Beam, obwohl er von den K√§mpfern vollst√§ndig getrunken wurde, dennoch Sieger in dieser
                        schwierigen Schlacht, die
                        um 9 Uhr morgens begann und um 2 Uhr nachts endete.
                        <br>
                        <br><i>Der Tag wird kommen, an dem die legend√§re Schlacht erneut stattfinden wird...</i>
                    </p>

                </div>

                <div class="timeline-item">

                    <h3>Institutionalisierung, erste Versammlung des Hauses Falcone</h3>
                    <div class="date">10.-11. Oktober 2025</div>
                    <p>Am 10. Oktober wurde bei einem Treffen der K√§mpfer des Hauses Falcone beschlossen, die legend√§re
                        Gruppe in
                        Telegram unter dem Namen "Haus Falcone" zu erstellen. Dmitrij wurde beauftragt, das Logo f√ºr
                        das Haus Falcone zu entwerfen. Genau dadurch erhielt Dmitrij den Titel "de Patrone".</p>

                    <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <img src="../../assets/images/history6.jpg" alt="–ü–µ—Ä–≤–æ–µ —Å–æ–±—Ä–∞–Ω–∏–µ"
                            style="width: 55%; max-width: 800px; border-radius: 8px;">
                    </div>
                    <p class="image-caption"
                        style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                        Auf dem Foto: Erste Versammlung des Hauses Falcone nach der Gro√üen Schlacht (10. Oktober 2025)
                    </p>

                    <p style="margin-top: 1rem;">Dimone de Patrone entwickelte 6 Logo-Varianten f√ºr das Haus Falcone:
                    </p>

                    <style>
                        @keyframes glowPulse {
                            0% {
                                box-shadow: 0 0 10px rgba(255, 23, 68, 0.3), inset 0 0 10px rgba(255, 23, 68, 0.1);
                            }

                            50% {
                                box-shadow: 0 0 30px rgba(255, 23, 68, 0.6), inset 0 0 20px rgba(255, 23, 68, 0.2);
                            }

                            100% {
                                box-shadow: 0 0 10px rgba(255, 23, 68, 0.3), inset 0 0 10px rgba(255, 23, 68, 0.1);
                            }
                        }

                        @keyframes slideIn {
                            from {
                                transform: scale(0.95) rotateY(10deg);
                                opacity: 0.8;
                            }

                            to {
                                transform: scale(1.08) rotateY(0deg);
                                opacity: 1;
                            }
                        }

                        .logo-item {
                            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
                            border-radius: 8px;
                            position: relative;
                            perspective: 1000px;
                        }

                        .logo-item:hover {
                            animation: glowPulse 1.5s ease-in-out forwards;
                            transform: scale(1.08) translateY(-8px);
                        }

                        .logo-item:hover img {
                            transform: scale(1.1);
                        }

                        /* Lightbox Styles */
                        .history-lightbox {
                            display: none;
                            position: fixed;
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 100%;
                            background: rgba(0, 0, 0, 0.95);
                            z-index: 10000;
                            justify-content: center;
                            align-items: center;
                            opacity: 0;
                            transition: opacity 0.3s ease;
                        }

                        .history-lightbox.active {
                            display: flex;
                            opacity: 1;
                        }

                        .history-lightbox-content {
                            position: relative;
                            max-width: 90vw;
                            max-height: 90vh;
                            animation: lightboxZoomIn 0.3s ease;
                        }

                        @keyframes lightboxZoomIn {
                            from {
                                transform: scale(0.8);
                                opacity: 0;
                            }

                            to {
                                transform: scale(1);
                                opacity: 1;
                            }
                        }

                        .history-lightbox-content img {
                            max-width: 90vw;
                            max-height: 85vh;
                            object-fit: contain;
                            border-radius: 8px;
                            box-shadow: 0 0 50px rgba(255, 23, 68, 0.3);
                        }

                        .history-lightbox-close {
                            position: absolute;
                            top: -40px;
                            right: -10px;
                            width: 35px;
                            height: 35px;
                            background: rgba(255, 23, 68, 0.8);
                            border: none;
                            border-radius: 50%;
                            color: white;
                            font-size: 24px;
                            cursor: pointer;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            transition: all 0.3s ease;
                        }

                        .history-lightbox-close:hover {
                            background: #ff1744;
                            transform: scale(1.1);
                        }

                        .history-lightbox-caption {
                            text-align: center;
                            color: #ccc;
                            margin-top: 15px;
                            font-size: 0.95rem;
                            max-width: 80vw;
                        }

                        /* Make timeline images clickable */
                        .timeline-item img {
                            cursor: pointer;
                            transition: transform 0.3s ease, box-shadow 0.3s ease;
                        }

                        .timeline-item img:hover {
                            transform: scale(1.02);
                            box-shadow: 0 5px 25px rgba(255, 23, 68, 0.4);
                        }

                        /* Navigation arrows */
                        .history-lightbox-nav {
                            position: absolute;
                            top: 50%;
                            transform: translateY(-50%);
                            width: 50px;
                            height: 50px;
                            background: rgba(255, 23, 68, 0.6);
                            border: none;
                            border-radius: 50%;
                            color: white;
                            font-size: 24px;
                            cursor: pointer;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            transition: all 0.3s ease;
                            z-index: 10001;
                        }

                        .history-lightbox-nav:hover {
                            background: #ff1744;
                        }

                        .history-lightbox-prev {
                            left: 20px;
                        }

                        .history-lightbox-next {
                            right: 20px;
                        }

                        @media (max-width: 768px) {
                            .history-lightbox-nav {
                                width: 40px;
                                height: 40px;
                                font-size: 20px;
                            }

                            .history-lightbox-prev {
                                left: 10px;
                            }

                            .history-lightbox-next {
                                right: 10px;
                            }

                            .history-lightbox-close {
                                top: -45px;
                                right: 0;
                            }
                        }
                    </style>

                    <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <div class="logo-item" style="width: 30%; max-width: 300px;">
                            <div style="height: 300px; overflow: hidden; border-radius: 8px;">
                                <img src="../../assets/images/logo1.jpg" alt="–õ–æ–≥–æ—Ç–∏–ø 1"
                                    style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease;">
                            </div>
                            <p class="image-caption"
                                style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                                Variante 1</p>
                        </div>
                        <div class="logo-item" style="width: 30%; max-width: 300px;">
                            <div style="height: 300px; overflow: hidden; border-radius: 8px;">
                                <img src="../../assets/images/logo2.jpg" alt="–õ–æ–≥–æ—Ç–∏–ø 2"
                                    style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease;">
                            </div>
                            <p class="image-caption"
                                style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                                Variante 2</p>
                        </div>
                        <div class="logo-item" style="width: 30%; max-width: 300px;">
                            <div style="height: 300px; overflow: hidden; border-radius: 8px;">
                                <img src="../../assets/images/logo3.jpg" alt="–õ–æ–≥–æ—Ç–∏–ø 3"
                                    style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease;">
                            </div>
                            <p class="image-caption"
                                style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                                Variante 3</p>
                        </div>
                        <div class="logo-item" style="width: 30%; max-width: 300px;">
                            <div style="height: 300px; overflow: hidden; border-radius: 8px;">
                                <img src="../../assets/images/logo4.jpg" alt="–õ–æ–≥–æ—Ç–∏–ø 4"
                                    style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease;">
                            </div>
                            <p class="image-caption"
                                style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                                Variante 4</p>
                        </div>
                        <div class="logo-item" style="width: 30%; max-width: 300px;">
                            <div style="height: 300px; overflow: hidden; border-radius: 8px;">
                                <img src="../../assets/images/logo5.jpg" alt="–õ–æ–≥–æ—Ç–∏–ø 5"
                                    style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease;">
                            </div>
                            <p class="image-caption"
                                style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                                –í–∞—Ä–∏–∞–Ω—Ç 5</p>
                        </div>
                        <div class="logo-item" style="width: 30%; max-width: 300px;">
                            <div style="height: 300px; overflow: hidden; border-radius: 8px;">
                                <img src="../../assets/images/logo6.jpg" alt="–õ–æ–≥–æ—Ç–∏–ø 6"
                                    style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease;">
                            </div>
                            <p class="image-caption"
                                style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                                –í–∞—Ä–∏–∞–Ω—Ç 6</p>
                        </div>
                    </div>

                    <p style="margin-top: 1rem;">Letztendlich w√§hlte Don Falcone Variante Nr. 4, und Dmitrij erhielt
                        den Titel "de Patrone". Von diesem Tag an hatte das Haus Falcone den Status einer organisierten
                        Struktur mit
                        eigener Identit√§t und Ideologie - Una Fides, Unus Dominus (ein Glaube, ein Don).</p>

                    <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <img src="../../assets/images/Falcone.png" alt="Wappen des Hauses Falcone"
                            style="width: 55%; max-width: 800px; border-radius: 8px;">
                    </div>
                    <p class="image-caption"
                        style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                        Auf dem Foto: Variante Nr. 4 ‚Äî das offizielle Wappen des Hauses Falcone
                    </p>


                </div>

                <div class="timeline-item">
                    <h3>Zweite Versammlung des Hauses Falcone</h3>
                    <div class="date">17.-18. Oktober 2025</div>
                    <p>Die zweite Versammlung des Hauses Falcone fand am 17. Oktober 2025 statt. Bemerkenswert ist, dass
                        Dimone
                        de Patrone und Maxone de Povarone die Versammlung schon lange vor dem Abend begannen. Als Gegner
                        wurde Vodka ThreeSixty gew√§hlt, der von Dimone und Maxone mit Beteiligung von Maxones
                        Vater vernichtet wurde. Zusammen mit umwerfenden Snacks kapitulierte der Wodka vor dem Ansturm
                        der K√§mpfer.</p>

                    <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <img src="../../assets/images/history7.jpg" alt="–í–æ–¥–∫–∞ —Å –∫–æ–ª–æ–π"
                            style="width: 45%; max-width: 800px; border-radius: 8px;">
                    </div>
                    <p class="image-caption"
                        style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                        Auf dem Foto: Vodka ThreeSixty vor Beginn des Kampfes
                    </p>

                    <p style="margin-top: 1rem;">Nach dem erfolgreichen Sieg √ºber den Wodka schloss sich Don
                        Falcone Dimone und Maxone an. Es wurde eine weitere Portion Bier gekauft und die K√§mpfer gingen
                        zu Don Falcone nach Hause,
                        sp√§ter kam Anton dazu. Dort begannen die K√§mpfer, Bier zu vernichten und die legend√§re
                        Shisha des Hauses Falcone zu rauchen, die fortan bei fast jeder Versammlung geraucht wird.
                        Zusammen mit
                        der Tradition, Shisha zu rauchen, entstand auch die Tradition, Kartoffeln im Airfryer als
                        Snack zuzubereiten. Jede Versammlung des Hauses Falcone wird von drei Hauptelementen begleitet -
                        Bier, Shisha und
                        Kartoffeln.</p>

                    <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <img src="../../assets/images/history8.jpg" alt="–í–æ–∏–Ω—ã –∫—É—Ä—è—Ç –∫–∞–ª—å—è–Ω"
                            style="width: 45%; max-width: 800px; border-radius: 8px;">
                    </div>
                    <p class="image-caption"
                        style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                        Auf dem Foto: Das Haus Falcone sitzt am Tisch und raucht Shisha
                    </p>

                    <p style="margin-top: 1rem;">W√§hrend dieses Abends war auch das legend√§re Artefakt auf dem Tisch
                        - das Bier "Lwiwske".</p>

                    <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <img src="../../assets/images/history9.jpg" alt="–õ—å–≤–æ–≤—Å–∫–æ–µ –ø–∏–≤–æ"
                            style="width: 45%; max-width: 800px; border-radius: 8px;">
                    </div>
                    <p class="image-caption"
                        style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                        Auf dem Foto: Bier "Lwiwske"
                    </p>

                    <p style="margin-top: 1rem;">Die Atmosph√§re des Abends war so angenehm, dass die Krieger
                        beschlossen,
                        bei Don Falcone zu √ºbernachten.</p>

                    <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <img src="../../assets/images/history10.jpg" alt="–î–∏–º–æ–Ω–µ –∏ –ú–∞–∫—Å–æ–Ω–µ —Å–ø—è—Ç"
                            style="width: 45%; max-width: 800px; border-radius: 8px;">
                    </div>
                    <p class="image-caption"
                        style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                        Auf dem Foto: Dimone de Patrone und Maxone de Povarone schlafen nach der zweiten Versammlung des
                        Hauses Falcone
                    </p>

                    <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <img src="../../assets/images/history11.jpg" alt="–ú–∞–∫—Å–æ–Ω–µ –ü–æ–≤–∞—Ä–æ–Ω–µ –≤ —à–∞–ø–æ—á–∫–µ –î–∂–µ—Å—Å–∏ –ü–∏–Ω–∫–∞"
                            style="width: 45%; max-width: 800px; border-radius: 8px;">
                    </div>
                    <p class="image-caption"
                        style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                        Auf dem Foto: Maxone de Povarone am n√§chsten Morgen (√§hnelt Jesse Pinkman aus "Breaking Bad")
                    </p>

                </div>

                <div class="timeline-item">
                    <h3>Dritte Versammlung des Hauses Falcone: Best√§tigung der Hymne</h3>
                    <div class="date">25.-26. Oktober 2025</div>
                    <p>Die dritte Versammlung des Hauses Falcone ist dadurch bemerkenswert, dass zum ersten Mal ein
                        Kandidat f√ºr den
                        Beitritt zum Haus Falcone anwesend war - Ivan. Vor der Versammlung hatten Dimone de Patrone und
                        Ivan instabile Beziehungen, aber
                        nach ein paar Gl√§sern hochprozentiger Getr√§nke konnten Dimone und Ivan eine gemeinsame Sprache
                        finden und
                        vergangene Beleidigungen vergessen. Der Abend verlief in warmer Atmosph√§re, die K√§mpfer des
                        Hauses Falcone konnten die Gesellschaft
                        des anderen genie√üen. An diesem Abend wurde auch ein Angriff auf den ukrainischen Chat der Stadt
                        Osnabr√ºck in Telegram durchgef√ºhrt.
                        Die K√§mpfer des Hauses Falcone handelten koordiniert zur Verteidigung der Interessen des Hauses
                        Falcone im virtuellen Raum.
                        Am Ende des Abends, als die K√§mpfer sich bereits verabschieden wollten, erklang die Hymne des
                        Hauses Falcone.
                        Antone de Snusone und Dimone de Patrone f√ºhrten den rituellen Tanz auf, der dann im offiziellen
                        Telegram-Kanal ver√∂ffentlicht wurde.
                        Ivan und Dimone de Patrone verlie√üen das Haus Falcone zusammen und fuhren mit demselben Bus nach
                        Hause.
                    </p>

                    <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <video width="40%" style="max-width: 600px; border-radius: 8px;" controls>
                            <source src="../../assets/images/history13.mp4" type="video/mp4">
                            –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Videos
                        </video>
                    </div>
                    <p class="image-caption"
                        style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                        Im Video: Ritueller Tanz von Antone de Snusone und Dimone de Patrone zur Hymne des Hauses
                        Falcone
                    </p>

                    <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <video width="40%" style="max-width: 600px; border-radius: 8px;" controls>
                            <source src="../../assets/images/history14.mp4" type="video/mp4">
                            –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Videos
                        </video>
                    </div>
                    <p class="image-caption"
                        style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                        Im Video: Ivan und Antone de Snusone tanzen zur Hymne
                    </p>

                    <p style="margin-top: 1rem;">Bemerkenswert ist auch, dass Don Falcone vor Beginn der Versammlung
                        seine JBL Charge 6 in Blau gekauft hat, die ihn seitdem auf allen seinen Ausfl√ºgen und
                        Versammlungen des Hauses Falcone begleitet.
                    </p>

                </div>

                <div class="timeline-item">
                    <h3>Und was kommt als N√§chstes?</h3>
                    <div class="date">Gegenwart</div>
                    <p>Heute existiert das Haus Falcone weiterhin und f√ºhrt jeden Freitag K√§mpfe durch. Derzeit
                        hat das Haus Falcone bereits so viel Gewicht gewonnen, dass es w√∂chentlich neue Kandidaten f√ºr
                        den
                        Beitritt zu unserer Kampfbruderschaft testet. Das Haus Falcone lebt und wird weiterleben, denn
                        alle seine
                        Mitglieder verstehen, dass die Erste Gro√üe Schlacht zwar verloren wurde, aber beim n√§chsten Mal
                        werden wir
                        st√§rker sein und den Gegner um jeden Preis besiegen.</p>

                    <div style="display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <img src="../../assets/images/history12.jpg"
                            alt="Haus Falcone und Vertraute in der Bierabteilung bei Edeka"
                            style="width: 65%; max-width: 800px; border-radius: 8px;">
                    </div>
                    <p class="image-caption"
                        style="font-size:0.95rem; color:#bbbbbb; margin-top:0.75rem; text-align: center;">
                        Auf dem Foto: Vertreter des Hauses Falcone und Beitrittskandidaten <br>
                        in der Bierabteilung bei Edeka auf der Johannisstra√üe (21.11.2025)
                    </p>

                </div>
            </div>
        </div>
        <section class="join-section">
            <div class="container">
                <div style="text-align: center; padding: 3rem 0;">
                    <h2 class="underline-text">M√∂chtest du dem Haus Falcone beitreten?</h2>
                    <p>Schlie√üe dich unserer Kampfbruderschaft an und beweise deine St√§rke!</p>
                    <a href="../contact" class="btn-primary"
                        style="display: inline-block; padding: 12px 32px; background: transparent; color: #ff1744; text-decoration: none; border-radius: 50px; font-weight: 600; transition: all 0.3s ease; border: 2px solid #ff1744; margin-top: 1rem; cursor: pointer;"
                        onmouseover="this.style.background='linear-gradient(135deg, #ff1744, #d32f2f)'; this.style.color='white';"
                        onmouseout="this.style.background='transparent'; this.style.color='#ff1744';">Kontakt mit
                        dem Don</a>
                </div>
            </div>
        </section>
    </main>

    <!-- Image Lightbox Modal -->
    <div class="history-lightbox" id="historyLightbox">
        <button class="history-lightbox-nav history-lightbox-prev" id="lightboxPrev">‚ùÆ</button>
        <div class="history-lightbox-content">
            <button class="history-lightbox-close" id="lightboxClose">√ó</button>
            <img src="" alt="" id="lightboxImage">
            <p class="history-lightbox-caption" id="lightboxCaption"></p>
        </div>
        <button class="history-lightbox-nav history-lightbox-next" id="lightboxNext">‚ùØ</button>
    </div>

    <footer class="site-footer">
        <div class="container">
            <small>¬© Dom Falcone 2026. Alle Rechte vorbehalten. Wirklich alle.</small>
            <div class="site-version"></div>
            <div class="footer-links">
                <a href="../faq">FAQ</a>
                <a href="../privacy">Datenschutz</a>
                <a href="../agreement">Nutzungsbedingungen</a>
                <a href="../imprint">Impressum</a>
                <a href="../developers">Entwickler</a>
                <a href="../hymn">Wappen & Hymne</a>
            </div>
        </div>
    </footer>

    <a href="../contact" class="floating-contact-btn">
        <img src="../../assets/images/phone-icon.png" alt="Contact">
        <span class="btn-text">Kontakt zum Haus</span>
    </a>


    <script src="../../assets/js/main.js?v=6"></script>
    <script>
        const API_BASE = "https://dom-falcone-auth.dom-falcone-official.workers.dev/api";
        const token = localStorage.getItem('auth_token');
        let notificationsInterval;
        let messagesCheckInterval;
        let lastMessageCount = 0;

        // ============ SYNCHRONOUS AUTH CHECK (prevents flash) ============
        (function syncAuthCheck() {
            const authAction = document.getElementById('auth-action');
            const userMenu = document.getElementById('user-menu');

            if (token) {
                if (authAction) authAction.style.display = 'none';
                if (userMenu) userMenu.style.display = 'flex';
            } else {
                if (authAction) authAction.style.display = 'block';
                if (userMenu) userMenu.style.display = 'none';
            }
        })();

        // ============ –ó–ê–ì–†–£–ó–ö–ê HEADER ============
        async function loadUserHeader() {
            if (!token) {
                document.getElementById('auth-action').style.display = 'block';
                document.getElementById('user-menu').style.display = 'none';
                return;
            }

            try {
                const res = await fetch(API_BASE + "/me", {
                    headers: { "Authorization": "Bearer " + token }
                });

                if (res.ok) {
                    const currentUser = await res.json();
                    document.getElementById('auth-action').style.display = 'none';
                    document.getElementById('user-menu').style.display = 'flex';
                    document.getElementById('header-display-name').textContent = currentUser.display_name || currentUser.email.split('@')[0];
                    document.getElementById('header-points').textContent = currentUser.points || 0;

                    const avatar = document.getElementById('header-avatar');
                    if (currentUser.avatar_url) {
                        avatar.src = currentUser.avatar_url;
                    } else {
                        const initial = currentUser.display_name ? currentUser.display_name[0].toUpperCase() : 'U';
                        avatar.src = `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40'%3E%3Crect fill='%23ff1744' width='40' height='40'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' fill='white' font-size='20' font-family='Arial'%3E${initial}%3C/text%3E%3C/svg%3E`;
                    }

                    // –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ —Å–æ–æ–±—â–µ–Ω–∏–π
                    loadNotifications();
                    loadUnreadMessagesCount();

                    if (notificationsInterval) clearInterval(notificationsInterval);
                    notificationsInterval = setInterval(loadNotifications, 30000);

                    if (messagesCheckInterval) clearInterval(messagesCheckInterval);
                    messagesCheckInterval = setInterval(checkNewMessages, 5000);
                } else {
                    localStorage.removeItem('auth_token');
                    document.getElementById('auth-action').style.display = 'block';
                    document.getElementById('user-menu').style.display = 'none';
                }
            } catch (err) {
                console.error('Error:', err);
                document.getElementById('auth-action').style.display = 'block';
                document.getElementById('user-menu').style.display = 'none';
            }
        }

        // ============ –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ============
        let lastNotificationId = 0; // –î–æ–±–∞–≤—å—Ç–µ —ç—Ç—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≥–ª–æ–±–∞–ª—å–Ω–æ

        async function loadNotifications() {
            if (!token) return;

            try {
                const res = await fetch(API_BASE + "/notifications", {
                    headers: { "Authorization": "Bearer " + token }
                });

                if (res.ok) {
                    const data = await res.json();
                    updateNotificationBadge(data.unread_count);
                    renderNotifications(data.notifications);

                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è toast
                    if (data.notifications && data.notifications.length > 0) {
                        const latestNotif = data.notifications[0];

                        // –ï—Å–ª–∏ —ç—Ç–æ –Ω–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏ –æ–Ω–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ
                        if (latestNotif.id > lastNotificationId && latestNotif.is_read === 0) {
                            showNotificationToast(
                                latestNotif.type,
                                latestNotif.title,
                                latestNotif.message,
                                latestNotif.id,
                                latestNotif.related_id
                            );
                            lastNotificationId = latestNotif.id;
                        } else if (lastNotificationId === 0) {
                            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ
                            lastNotificationId = latestNotif.id;
                        }
                    }
                }
            } catch (err) {
                console.error('Load notifications error:', err);
            }
        }

        function showNotificationToast(type, title, message, notificationId, relatedId) {
            // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π toast –µ—Å–ª–∏ –µ—Å—Ç—å
            const existingToast = document.querySelector('.toast-notification');
            if (existingToast) existingToast.remove();

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–∫–æ–Ω–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
            let icon = 'üîî';
            let redirectUrl = null;
            let soundFile = 'notification';

            switch (type) {
                case 'new_message':
                    icon = 'üí¨';
                    soundFile = 'message-notification';
                    redirectUrl = '../messages';
                    break;
                case 'news_like':
                    icon = '‚ù§Ô∏è';
                    redirectUrl = relatedId ? `../news?id=${relatedId}` : '../news';
                    break;
                case 'news_comment':
                    icon = 'üí≠';
                    redirectUrl = relatedId ? `../news?id=${relatedId}` : '../news';
                    break;
                case 'news_friend':
                    icon = 'üì∞';
                    redirectUrl = relatedId ? `../news?id=${relatedId}` : '../news';
                    break;
                case 'news_deleted':
                    icon = 'üóëÔ∏è';
                    redirectUrl = '../news';
                    break;
                case 'friend_request':
                    icon = 'üë•';
                    redirectUrl = '../dashboard?tab=friends';
                    break;
                default:
                    icon = 'üîî';
            }

            // –ü—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º –∑–≤—É–∫
            playNotificationSound(soundFile);

            // –°–æ–∑–¥–∞–µ–º toast
            const toast = document.createElement('div');
            toast.className = 'toast-notification';
            toast.innerHTML = `
        <div class="toast-icon">${icon}</div>
        <div class="toast-content">
            <div class="toast-name">${title}</div>
            <div class="toast-message">${message}</div>
        </div>
    `;

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
            toast.addEventListener('click', async () => {
                // –û—Ç–º–µ—á–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ
                try {
                    await fetch(API_BASE + "/notifications/read", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': 'Bearer ' + token
                        },
                        body: JSON.stringify({ notificationId })
                    });
                    await loadNotifications();
                } catch (err) {
                    console.error('Mark notification read error:', err);
                }

                // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ —Å—Å—ã–ª–∫–µ
                if (redirectUrl) {
                    window.location.href = redirectUrl;
                }
            });

            document.body.appendChild(toast);

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                toast.classList.add('hide');
                setTimeout(() => toast.remove(), 300);
            }, 5000);
        }

        function playNotificationSound(soundType) {
            try {
                const soundId = soundType === 'message-notification'
                    ? 'message-notification-sound'
                    : 'notification-sound';

                const audio = document.getElementById(soundId);
                if (audio) {
                    audio.currentTime = 0;
                    audio.volume = 0.5; // –ì—Ä–æ–º–∫–æ—Å—Ç—å 50%
                    audio.play().catch(err => {
                        console.log('Audio play prevented:', err);
                    });
                }
            } catch (err) {
                console.error('Play sound error:', err);
            }
        }

        function updateNotificationBadge(count) {
            const badge = document.getElementById('notification-badge');
            if (count > 0) {
                badge.textContent = count > 99 ? '99+' : count;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        }

        function renderNotifications(notifications) {
            const list = document.getElementById('notifications-list');

            if (!notifications || notifications.length === 0) {
                list.innerHTML = '<div class="no-notifications">Keine Benachrichtigungen</div>';
                return;
            }

            list.innerHTML = notifications.map(notif => {
                const time = formatNotificationTime(notif.created_at);
                const unreadClass = notif.is_read === 0 ? 'unread' : '';

                return `
            <div class="notification-item ${unreadClass}" onclick="handleNotificationClick(${notif.id}, ${notif.related_id}, '${notif.type}')">
                <div class="notification-title">${notif.title}</div>
                <div class="notification-message">${notif.message}</div>
                <div class="notification-time">${time}</div>
            </div>
        `;
            }).join('');
        }

        function formatNotificationTime(timestamp) {
            const now = Date.now();
            const diff = now - timestamp;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);

            if (minutes < 1) return 'Gerade eben';
            if (minutes < 60) return `${minutes} Min. her`;
            if (hours < 24) return `${hours} Std. her`;
            if (days < 7) return `${days} T. her`;

            return new Date(timestamp).toLocaleDateString('ru-RU');
        }

        async function handleNotificationClick(notificationId, relatedId, type) {
            try {
                await fetch(API_BASE + "/notifications/read", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + token
                    },
                    body: JSON.stringify({ notificationId })
                });

                await loadNotifications();
                document.getElementById('notifications-dropdown').classList.remove('active');

                // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–≤—è–∑–∞–Ω–Ω–æ–º—É –∫–æ–Ω—Ç–µ–Ω—Ç—É
                if (type === 'new_message' && relatedId) {
                    window.location.href = `../messages`;
                } else if (type.includes('news') && relatedId) {
                    window.location.href = `../news`;
                }
            } catch (err) {
                console.error('Handle notification click error:', err);
            }
        }

        // ============ –°–û–û–ë–©–ï–ù–ò–Ø ============
        async function loadUnreadMessagesCount() {
            if (!token) return;

            try {
                const res = await fetch(API_BASE + "/messages/unread-count", {
                    headers: { "Authorization": "Bearer " + token }
                });

                if (res.ok) {
                    const data = await res.json();
                    updateMessagesBadge(data.unread_count);
                }
            } catch (err) {
                console.error('Load unread messages error:', err);
            }
        }

        function updateMessagesBadge(count) {
            const badge = document.getElementById('messages-badge');
            if (badge) {
                if (count > 0) {
                    badge.textContent = count > 99 ? '99+' : count;
                    badge.style.display = 'flex';
                } else {
                    badge.style.display = 'none';
                }
            }
        }

        async function checkNewMessages() {
            if (!token) return;

            try {
                const res = await fetch(API_BASE + "/messages/unread-count", {
                    headers: { "Authorization": "Bearer " + token }
                });

                if (res.ok) {
                    const data = await res.json();

                    if (data.unread_count > lastMessageCount && lastMessageCount > 0) {
                        const chatsRes = await fetch(API_BASE + "/chats", {
                            headers: { "Authorization": "Bearer " + token }
                        });

                        if (chatsRes.ok) {
                            const chatsData = await chatsRes.json();
                            const latestChat = chatsData.chats.find(c => c.unread_count > 0);

                            if (latestChat && latestChat.last_message) {
                                showMessageToast(
                                    latestChat.other_user.name,
                                    latestChat.other_user.avatar,
                                    latestChat.last_message.content,
                                    latestChat.chat_id,
                                    latestChat.other_user.id
                                );
                            }
                        }
                    }

                    lastMessageCount = data.unread_count;
                    updateMessagesBadge(data.unread_count);
                }
            } catch (err) {
                console.error('Check new messages error:', err);
            }
        }

        function showMessageToast(senderName, senderAvatar, messagePreview, chatId, senderId) {
            const existingToast = document.querySelector('.toast-notification');
            if (existingToast) existingToast.remove();

            // –ü—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º –∑–≤—É–∫ —Å–æ–æ–±—â–µ–Ω–∏—è
            playNotificationSound('message-notification');

            const toast = document.createElement('div');
            toast.className = 'toast-notification';
            toast.innerHTML = `
        <img src="${senderAvatar || getDefaultAvatar(senderName)}" class="toast-avatar">
        <div class="toast-content">
            <div class="toast-name">${senderName}</div>
            <div class="toast-message">${messagePreview}</div>
        </div>
    `;

            toast.addEventListener('click', () => {
                window.location.href = `../messages?chatWith=${senderId}`;
            });

            document.body.appendChild(toast);

            setTimeout(() => {
                toast.classList.add('hide');
                setTimeout(() => toast.remove(), 300);
            }, 5000);
        }

        function getDefaultAvatar(name) {
            const initial = name ? name[0].toUpperCase() : '?';
            return `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='45' height='45'%3E%3Crect fill='%23ff1744' width='45' height='45'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' fill='white' font-size='20' font-family='Arial'%3E${initial}%3C/text%3E%3C/svg%3E`;
        }

        // ============ –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô ============
        document.getElementById('notification-bell')?.addEventListener('click', (e) => {
            e.stopPropagation();
            const dropdown = document.getElementById('notifications-dropdown');
            dropdown.classList.toggle('active');
            if (dropdown.classList.contains('active')) {
                loadNotifications();
            }
        });

        document.getElementById('mark-all-read-btn')?.addEventListener('click', async () => {
            try {
                await fetch(API_BASE + "/notifications/read-all", {
                    method: 'POST',
                    headers: { 'Authorization': 'Bearer ' + token }
                });
                await loadNotifications();
            } catch (err) {
                console.error('Mark all read error:', err);
            }
        });

        document.addEventListener('click', (e) => {
            const dropdown = document.getElementById('notifications-dropdown');
            const bell = document.getElementById('notification-bell');
            if (dropdown && !dropdown.contains(e.target) && !bell.contains(e.target)) {
                dropdown.classList.remove('active');
            }
        });

        // ============ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ============
        document.addEventListener('DOMContentLoaded', loadUserHeader);

        // ============ LIGHTBOX FUNCTIONALITY ============
        (function initLightbox() {
            const lightbox = document.getElementById('historyLightbox');
            const lightboxImage = document.getElementById('lightboxImage');
            const lightboxCaption = document.getElementById('lightboxCaption');
            const lightboxClose = document.getElementById('lightboxClose');
            const lightboxPrev = document.getElementById('lightboxPrev');
            const lightboxNext = document.getElementById('lightboxNext');

            // Collect all images from timeline
            let images = [];
            let currentIndex = 0;

            function collectImages() {
                images = [];
                const timelineImages = document.querySelectorAll('.timeline-item img');
                timelineImages.forEach((img, index) => {
                    // Find the caption if exists
                    let caption = '';
                    const parent = img.closest('div[style*="display: flex"]');
                    if (parent) {
                        const captionEl = parent.nextElementSibling;
                        if (captionEl && captionEl.classList.contains('image-caption')) {
                            caption = captionEl.textContent || '';
                        }
                    }
                    // Also check if caption is a sibling inside the same container
                    const container = img.parentElement;
                    const siblingCaption = container.querySelector('.image-caption');
                    if (siblingCaption) {
                        caption = siblingCaption.textContent || '';
                    }

                    images.push({
                        src: img.src,
                        alt: img.alt,
                        caption: caption || img.alt
                    });

                    // Add click handler
                    img.addEventListener('click', () => openLightbox(index));
                });
            }

            function openLightbox(index) {
                currentIndex = index;
                updateLightboxImage();
                lightbox.classList.add('active');
                document.body.style.overflow = 'hidden';
            }

            function closeLightbox() {
                lightbox.classList.remove('active');
                document.body.style.overflow = '';
            }

            function updateLightboxImage() {
                if (images[currentIndex]) {
                    lightboxImage.src = images[currentIndex].src;
                    lightboxImage.alt = images[currentIndex].alt;
                    lightboxCaption.textContent = images[currentIndex].caption;
                }
                // Update navigation visibility
                lightboxPrev.style.display = images.length > 1 ? 'flex' : 'none';
                lightboxNext.style.display = images.length > 1 ? 'flex' : 'none';
            }

            function navigatePrev() {
                currentIndex = (currentIndex - 1 + images.length) % images.length;
                updateLightboxImage();
            }

            function navigateNext() {
                currentIndex = (currentIndex + 1) % images.length;
                updateLightboxImage();
            }

            // Event listeners
            lightboxClose.addEventListener('click', closeLightbox);
            lightboxPrev.addEventListener('click', (e) => {
                e.stopPropagation();
                navigatePrev();
            });
            lightboxNext.addEventListener('click', (e) => {
                e.stopPropagation();
                navigateNext();
            });

            // Close on background click
            lightbox.addEventListener('click', (e) => {
                if (e.target === lightbox) {
                    closeLightbox();
                }
            });

            // Keyboard navigation
            document.addEventListener('keydown', (e) => {
                if (!lightbox.classList.contains('active')) return;

                switch (e.key) {
                    case 'Escape':
                        closeLightbox();
                        break;
                    case 'ArrowLeft':
                        navigatePrev();
                        break;
                    case 'ArrowRight':
                        navigateNext();
                        break;
                }
            });

            // Touch swipe support for mobile
            let touchStartX = 0;
            let touchStartY = 0;
            let touchEndX = 0;
            let touchEndY = 0;
            const minSwipeDistance = 50;

            lightbox.addEventListener('touchstart', (e) => {
                touchStartX = e.changedTouches[0].screenX;
                touchStartY = e.changedTouches[0].screenY;
            }, { passive: true });

            lightbox.addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].screenX;
                touchEndY = e.changedTouches[0].screenY;
                handleSwipe();
            }, { passive: true });

            function handleSwipe() {
                const deltaX = touchEndX - touchStartX;
                const deltaY = touchEndY - touchStartY;

                // Only handle horizontal swipes (ignore if vertical movement is greater)
                if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > minSwipeDistance) {
                    if (deltaX > 0) {
                        // Swipe right - go to previous image
                        navigatePrev();
                    } else {
                        // Swipe left - go to next image
                        navigateNext();
                    }
                }
            }

            // Initialize on DOM ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', collectImages);
            } else {
                collectImages();
            }
        })();
    </script>

    <!-- Audio for notifications -->
    <audio id="notification-sound" preload="auto">
        <source src="../../assets/audio/notification.mp3" type="audio/mpeg">
    </audio>
    <audio id="message-notification-sound" preload="auto">
        <source src="../../assets/audio/message-notification.mp3" type="audio/mpeg">
    </audio>
    <script src="../../assets/js/analytics.js"></script>
</body>

</html>